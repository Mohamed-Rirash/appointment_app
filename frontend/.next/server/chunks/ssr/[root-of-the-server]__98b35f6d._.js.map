{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///G:/projects/backend/appointment_app/frontend/fuctions/api/client.ts"],"sourcesContent":["//schema\r\n\r\ninterface Userdata {\r\n  email: string;\r\n  first_name: string;\r\n  is_active: boolean;\r\n  is_verified: boolean;\r\n  last_name: string;\r\n  role: string;\r\n  send_welcome_email: boolean;\r\n}\r\n\r\nexport const client = {\r\n  // login\r\n  async Login(email: string, password: string) {\r\n    console.log(\"Email client\", email);\r\n    console.log(\"Password\", password);\r\n    const response = await fetch(\r\n      `${process.env.NEXT_PUBLIC_API_URL}/users/login`,\r\n      {\r\n        method: \"POST\",\r\n        headers: {\r\n          accept: \"application/json\",\r\n          \"Content-Type\": \"application/x-www-form-urlencoded\",\r\n        },\r\n        body: `grant_type=password&username=${email}&password=${password}&scope=&client_id=string&client_secret=********`,\r\n        credentials: \"include\",\r\n      }\r\n    );\r\n    return response;\r\n  },\r\n\r\n  // get user\r\n  async GetUser(token: string) {\r\n    const response = await fetch(\r\n      `${process.env.NEXT_PUBLIC_API_URL}/users/me`,\r\n      {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      }\r\n    );\r\n    return response;\r\n  },\r\n\r\n  // refresh token\r\n  async refreshAccessToken() {\r\n    try {\r\n      const res = await fetch(\r\n        `${process.env.NEXT_PUBLIC_API_URL}/users/refresh`,\r\n        {\r\n          method: \"POST\",\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n          },\r\n          // If your API already reads refresh_token from cookie, body may not be required\r\n          // body: JSON.stringify({ refresh_token: token.refresh_token }),\r\n          credentials: \"include\", // send cookies!\r\n        }\r\n      );\r\n\r\n      if (!res.ok) throw new Error(\"Failed to refresh token\");\r\n\r\n      const refreshed = await res.json();\r\n      console.log(\"shhhhhhhhhhhhhhhhhhhh\", refreshed);\r\n\r\n      return {\r\n        access_token: refreshed.access_token,\r\n        expires_at: Math.floor(Date.now() / 1000 + refreshed.expires_in),\r\n      };\r\n    } catch (err) {\r\n      console.error(\"Error refreshing token:\", err);\r\n      return { error: \"RefreshAccessTokenError\" };\r\n    }\r\n  },\r\n\r\n  // resetPassword\r\n  async resetPassword(email: string) {\r\n    console.log(\"|Email: reset\", email);\r\n    const response = await fetch(\r\n      `${process.env.NEXT_PUBLIC_API_URL}/users/request-password-reset`,\r\n      {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          accept: \"application/json\",\r\n        },\r\n        body: JSON.stringify({ email }),\r\n      }\r\n    );\r\n\r\n    // ðŸš¨ Also: Check if response is OK before parsing JSON\r\n    if (!response.ok) {\r\n      throw new Error(`HTTP error! status: ${response.status}`);\r\n      // return await response.json();\r\n    }\r\n\r\n    return await response.json();\r\n  },\r\n\r\n  // change password\r\n  async changePassword(\r\n    current_password: string,\r\n    new_password: string,\r\n    token: string\r\n  ) {\r\n    try {\r\n      const res = await fetch(\r\n        `${process.env.NEXT_PUBLIC_API_URL}/users/change-password`,\r\n        {\r\n          method: \"POST\",\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `Bearer ${token}`,\r\n          },\r\n          body: JSON.stringify({ current_password, new_password }),\r\n        }\r\n      );\r\n      const data = await res.json();\r\n      if (!res.ok) {\r\n        console.log(\"whateeeeeeeeeeee\");\r\n        throw new Error(data.detail || \"Failed to change password\");\r\n      }\r\n      return data;\r\n    } catch (error: any) {\r\n      console.error(\"error password change\", error);\r\n      throw error; // let caller handle\r\n    }\r\n  },\r\n\r\n  // create user admin\r\n  async createUser(data: Userdata) {\r\n    const response = await fetch(\r\n      `${process.env.NEXT_PUBLIC_API_URL}/admin/users`,\r\n      {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          accept: \"application/json\",\r\n        },\r\n        body: JSON.stringify({ data }),\r\n      }\r\n    );\r\n  },\r\n};\r\n"],"names":[],"mappings":"AAAA,QAAQ;;;;;AAYD,MAAM,SAAS;IACpB,QAAQ;IACR,MAAM,OAAM,KAAa,EAAE,QAAgB;QACzC,QAAQ,GAAG,CAAC,gBAAgB;QAC5B,QAAQ,GAAG,CAAC,YAAY;QACxB,MAAM,WAAW,MAAM,MACrB,oEAAmC,YAAY,CAAC,EAChD;YACE,QAAQ;YACR,SAAS;gBACP,QAAQ;gBACR,gBAAgB;YAClB;YACA,MAAM,CAAC,6BAA6B,EAAE,MAAM,UAAU,EAAE,SAAS,+CAA+C,CAAC;YACjH,aAAa;QACf;QAEF,OAAO;IACT;IAEA,WAAW;IACX,MAAM,SAAQ,KAAa;QACzB,MAAM,WAAW,MAAM,MACrB,oEAAmC,SAAS,CAAC,EAC7C;YACE,SAAS;gBACP,eAAe,CAAC,OAAO,EAAE,OAAO;YAClC;QACF;QAEF,OAAO;IACT;IAEA,gBAAgB;IAChB,MAAM;QACJ,IAAI;YACF,MAAM,MAAM,MAAM,MAChB,oEAAmC,cAAc,CAAC,EAClD;gBACE,QAAQ;gBACR,SAAS;oBACP,gBAAgB;gBAClB;gBACA,gFAAgF;gBAChF,gEAAgE;gBAChE,aAAa;YACf;YAGF,IAAI,CAAC,IAAI,EAAE,EAAE,MAAM,IAAI,MAAM;YAE7B,MAAM,YAAY,MAAM,IAAI,IAAI;YAChC,QAAQ,GAAG,CAAC,yBAAyB;YAErC,OAAO;gBACL,cAAc,UAAU,YAAY;gBACpC,YAAY,KAAK,KAAK,CAAC,KAAK,GAAG,KAAK,OAAO,UAAU,UAAU;YACjE;QACF,EAAE,OAAO,KAAK;YACZ,QAAQ,KAAK,CAAC,2BAA2B;YACzC,OAAO;gBAAE,OAAO;YAA0B;QAC5C;IACF;IAEA,gBAAgB;IAChB,MAAM,eAAc,KAAa;QAC/B,QAAQ,GAAG,CAAC,iBAAiB;QAC7B,MAAM,WAAW,MAAM,MACrB,oEAAmC,6BAA6B,CAAC,EACjE;YACE,QAAQ;YACR,SAAS;gBACP,gBAAgB;gBAChB,QAAQ;YACV;YACA,MAAM,KAAK,SAAS,CAAC;gBAAE;YAAM;QAC/B;QAGF,uDAAuD;QACvD,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,MAAM,IAAI,MAAM,CAAC,oBAAoB,EAAE,SAAS,MAAM,EAAE;QACxD,gCAAgC;QAClC;QAEA,OAAO,MAAM,SAAS,IAAI;IAC5B;IAEA,kBAAkB;IAClB,MAAM,gBACJ,gBAAwB,EACxB,YAAoB,EACpB,KAAa;QAEb,IAAI;YACF,MAAM,MAAM,MAAM,MAChB,oEAAmC,sBAAsB,CAAC,EAC1D;gBACE,QAAQ;gBACR,SAAS;oBACP,gBAAgB;oBAChB,eAAe,CAAC,OAAO,EAAE,OAAO;gBAClC;gBACA,MAAM,KAAK,SAAS,CAAC;oBAAE;oBAAkB;gBAAa;YACxD;YAEF,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,IAAI,CAAC,IAAI,EAAE,EAAE;gBACX,QAAQ,GAAG,CAAC;gBACZ,MAAM,IAAI,MAAM,KAAK,MAAM,IAAI;YACjC;YACA,OAAO;QACT,EAAE,OAAO,OAAY;YACnB,QAAQ,KAAK,CAAC,yBAAyB;YACvC,MAAM,OAAO,oBAAoB;QACnC;IACF;IAEA,oBAAoB;IACpB,MAAM,YAAW,IAAc;QAC7B,MAAM,WAAW,MAAM,MACrB,oEAAmC,YAAY,CAAC,EAChD;YACE,QAAQ;YACR,SAAS;gBACP,gBAAgB;gBAChB,QAAQ;YACV;YACA,MAAM,KAAK,SAAS,CAAC;gBAAE;YAAK;QAC9B;IAEJ;AACF","debugId":null}},
    {"offset": {"line": 129, "column": 0}, "map": {"version":3,"sources":["file:///G:/projects/backend/appointment_app/frontend/auth.ts"],"sourcesContent":["import NextAuth, { CredentialsSignin } from \"next-auth\";\r\nimport Credentials from \"next-auth/providers/credentials\";\r\nimport { client } from \"./fuctions/api/client\";\r\n\r\n// Extend NextAuth types\r\ndeclare module \"next-auth\" {\r\n  interface User {\r\n    first_name: string;\r\n    last_name: string;\r\n    id: string;\r\n    email: string;\r\n    emailVerified: Date | null;\r\n    is_active: boolean;\r\n    is_verified: boolean;\r\n    roles: string[];\r\n    permissions: string[];\r\n    access_token: string;\r\n    expires_at: number;\r\n  }\r\n\r\n  interface Session {\r\n    access_token: string;\r\n    error?: string;\r\n  }\r\n}\r\n\r\nexport class InvalidLoginError extends CredentialsSignin {\r\n  constructor(message: string) {\r\n    super(message);\r\n    this.message = message;\r\n  }\r\n}\r\n\r\nexport const { handlers, signIn, signOut, auth } = NextAuth({\r\n  providers: [\r\n    Credentials({\r\n      async authorize(credentials) {\r\n        const { email, password } = credentials as {\r\n          email: string;\r\n          password: string;\r\n        };\r\n\r\n        try {\r\n          // Login â†’ returns tokens\r\n          const response = await client.Login(email, password);\r\n          const data = await response.json();\r\n          if (!response.ok) {\r\n            console.log(\"Auuuht\", data);\r\n          }\r\n\r\n          if (!response.ok) throw new InvalidLoginError(data.detail);\r\n\r\n          // Fetch user profile with access_token\r\n          const userRes = await client.GetUser(data.access_token);\r\n          const user = await userRes.json();\r\n          console.log(\"User\", user);\r\n          return {\r\n            ...user,\r\n            access_token: data.access_token,\r\n            expires_at: Math.floor(Date.now() / 1000 + data.expires_in), // expiry in seconds\r\n          };\r\n        } catch (error: any) {\r\n          throw new InvalidLoginError(error.message);\r\n        }\r\n      },\r\n    }),\r\n  ],\r\n\r\n  callbacks: {\r\n    // Runs whenever token is created/updated\r\n    async jwt({ token, user }) {\r\n      // Initial login â†’ attach tokens + user info\r\n\r\n      if (user) {\r\n        return {\r\n          ...token,\r\n          id: user.id,\r\n          email: user.email,\r\n          firstName: user.first_name,\r\n          lastName: user.last_name,\r\n          roles: user.roles,\r\n          is_active: user.is_active,\r\n          is_verified: user.is_verified,\r\n          permissions: user.permissions,\r\n          access_token: user.access_token,\r\n          expires_at: user.expires_at,\r\n        };\r\n      }\r\n\r\n      // If token still valid â†’ return it\r\n      if (Date.now() < (token.expires_at as number) * 1000) {\r\n        return token;\r\n      }\r\n      // signOut();\r\n      // Otherwise refresh\r\n      const refreshed = await client.refreshAccessToken();\r\n\r\n      if (refreshed.error) {\r\n        return { ...token, error: \"RefreshAccessTokenError\" };\r\n      }\r\n\r\n      return {\r\n        ...token,\r\n        access_token: refreshed.access_token,\r\n        expires_at: refreshed.expires_at,\r\n      };\r\n    },\r\n\r\n    // What's sent to the client (session)\r\n    async session({ session, token }) {\r\n      session.user = {\r\n        id: token.id as string,\r\n        email: token.email as string,\r\n        emailVerified: (token.is_verified as boolean) ? new Date() : null,\r\n        first_name: token.firstName as string, // note: you stored it as 'firstName' in JWT\r\n        last_name: token.lastName as string,\r\n        is_active: token.is_active as boolean,\r\n        is_verified: token.is_verified as boolean,\r\n        roles: token.roles as string[],\r\n        permissions: token.permissions as string[],\r\n        access_token: token.access_token as string,\r\n        expires_at: token.expires_at as number,\r\n      };\r\n\r\n      session.access_token = token.access_token as string;\r\n      session.error = token.error as string | undefined;\r\n\r\n      return session;\r\n    },\r\n    // async session({ session, token }) {\r\n    //   session.user = {\r\n    //     id: token.id as string,\r\n    //     email: token.email as string,\r\n    //     emailVerified: null,\r\n    //     roles: token.roles as string[],\r\n    //     permissions: token.permissions as string[],\r\n    //     access_token: token.access_token as string,\r\n    //     expires_at: token.expires_at as number,\r\n    //   };\r\n\r\n    //   session.access_token = token.access_token as string;\r\n    //   session.error = token.error as string | undefined;\r\n\r\n    //   return session;\r\n    // },\r\n  },\r\n\r\n  pages: {\r\n    signIn: \"/signin\",\r\n  },\r\n});\r\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;AAAA;AACA;AAAA;AACA;;;;AAwBO,MAAM,0BAA0B,yNAAiB;IACtD,YAAY,OAAe,CAAE;QAC3B,KAAK,CAAC;QACN,IAAI,CAAC,OAAO,GAAG;IACjB;AACF;AAEO,MAAM,EAAE,QAAQ,EAAE,MAAM,EAAE,OAAO,EAAE,IAAI,EAAE,GAAG,IAAA,4QAAQ,EAAC;IAC1D,WAAW;QACT,IAAA,iOAAW,EAAC;YACV,MAAM,WAAU,WAAW;gBACzB,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG;gBAK5B,IAAI;oBACF,yBAAyB;oBACzB,MAAM,WAAW,MAAM,mIAAM,CAAC,KAAK,CAAC,OAAO;oBAC3C,MAAM,OAAO,MAAM,SAAS,IAAI;oBAChC,IAAI,CAAC,SAAS,EAAE,EAAE;wBAChB,QAAQ,GAAG,CAAC,UAAU;oBACxB;oBAEA,IAAI,CAAC,SAAS,EAAE,EAAE,MAAM,IAAI,kBAAkB,KAAK,MAAM;oBAEzD,uCAAuC;oBACvC,MAAM,UAAU,MAAM,mIAAM,CAAC,OAAO,CAAC,KAAK,YAAY;oBACtD,MAAM,OAAO,MAAM,QAAQ,IAAI;oBAC/B,QAAQ,GAAG,CAAC,QAAQ;oBACpB,OAAO;wBACL,GAAG,IAAI;wBACP,cAAc,KAAK,YAAY;wBAC/B,YAAY,KAAK,KAAK,CAAC,KAAK,GAAG,KAAK,OAAO,KAAK,UAAU;oBAC5D;gBACF,EAAE,OAAO,OAAY;oBACnB,MAAM,IAAI,kBAAkB,MAAM,OAAO;gBAC3C;YACF;QACF;KACD;IAED,WAAW;QACT,yCAAyC;QACzC,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACvB,4CAA4C;YAE5C,IAAI,MAAM;gBACR,OAAO;oBACL,GAAG,KAAK;oBACR,IAAI,KAAK,EAAE;oBACX,OAAO,KAAK,KAAK;oBACjB,WAAW,KAAK,UAAU;oBAC1B,UAAU,KAAK,SAAS;oBACxB,OAAO,KAAK,KAAK;oBACjB,WAAW,KAAK,SAAS;oBACzB,aAAa,KAAK,WAAW;oBAC7B,aAAa,KAAK,WAAW;oBAC7B,cAAc,KAAK,YAAY;oBAC/B,YAAY,KAAK,UAAU;gBAC7B;YACF;YAEA,mCAAmC;YACnC,IAAI,KAAK,GAAG,KAAK,AAAC,MAAM,UAAU,GAAc,MAAM;gBACpD,OAAO;YACT;YACA,aAAa;YACb,oBAAoB;YACpB,MAAM,YAAY,MAAM,mIAAM,CAAC,kBAAkB;YAEjD,IAAI,UAAU,KAAK,EAAE;gBACnB,OAAO;oBAAE,GAAG,KAAK;oBAAE,OAAO;gBAA0B;YACtD;YAEA,OAAO;gBACL,GAAG,KAAK;gBACR,cAAc,UAAU,YAAY;gBACpC,YAAY,UAAU,UAAU;YAClC;QACF;QAEA,sCAAsC;QACtC,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC9B,QAAQ,IAAI,GAAG;gBACb,IAAI,MAAM,EAAE;gBACZ,OAAO,MAAM,KAAK;gBAClB,eAAe,AAAC,MAAM,WAAW,GAAe,IAAI,SAAS;gBAC7D,YAAY,MAAM,SAAS;gBAC3B,WAAW,MAAM,QAAQ;gBACzB,WAAW,MAAM,SAAS;gBAC1B,aAAa,MAAM,WAAW;gBAC9B,OAAO,MAAM,KAAK;gBAClB,aAAa,MAAM,WAAW;gBAC9B,cAAc,MAAM,YAAY;gBAChC,YAAY,MAAM,UAAU;YAC9B;YAEA,QAAQ,YAAY,GAAG,MAAM,YAAY;YACzC,QAAQ,KAAK,GAAG,MAAM,KAAK;YAE3B,OAAO;QACT;IAiBF;IAEA,OAAO;QACL,QAAQ;IACV;AACF","debugId":null}},
    {"offset": {"line": 249, "column": 0}, "map": {"version":3,"sources":["file:///G:/projects/backend/appointment_app/frontend/fuctions/services/action.ts"],"sourcesContent":["\"use server\";\r\nimport { InvalidLoginError, signIn } from \"@/auth\";\r\n\r\nexport async function authenticate(email: string, password: string) {\r\n  try {\r\n    const r = await signIn(\"credentials\", {\r\n      email,\r\n      password,\r\n      redirect: false,\r\n      // redirectTo: \"/\",\r\n    });\r\n    return { message: \"success\" }; // success case\r\n  } catch (error) {\r\n    if (error instanceof InvalidLoginError) {\r\n      // unwrap and return only the message\r\n      return { error: error.message };\r\n    }\r\n    console.error(\"Unexpected error\", error);\r\n    return { error: \"Something went wrong. Please try again.\" };\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;AACA;;;;AAEO,eAAe,aAAa,KAAa,EAAE,QAAgB;IAChE,IAAI;QACF,MAAM,IAAI,MAAM,IAAA,8GAAM,EAAC,eAAe;YACpC;YACA;YACA,UAAU;QAEZ;QACA,OAAO;YAAE,SAAS;QAAU,GAAG,eAAe;IAChD,EAAE,OAAO,OAAO;QACd,IAAI,iBAAiB,yHAAiB,EAAE;YACtC,qCAAqC;YACrC,OAAO;gBAAE,OAAO,MAAM,OAAO;YAAC;QAChC;QACA,QAAQ,KAAK,CAAC,oBAAoB;QAClC,OAAO;YAAE,OAAO;QAA0C;IAC5D;AACF;;;IAjBsB;;AAAA,8VAAA","debugId":null}},
    {"offset": {"line": 290, "column": 0}, "map": {"version":3,"sources":["file:///G:/projects/backend/appointment_app/frontend/.next-internal/server/app/%28auth%29/Signin/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {authenticate as '6034975c8e7fcb1eee48b6db461cfb9fdcd3358d60'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA","debugId":null}},
    {"offset": {"line": 315, "column": 0}, "map": {"version":3,"sources":["file:///G:/projects/backend/appointment_app/frontend/app/%28auth%29/Signin/page.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/app/(auth)/Signin/page.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/(auth)/Signin/page.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,uXAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAA8R,GAC3T,4DACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 329, "column": 0}, "map": {"version":3,"sources":["file:///G:/projects/backend/appointment_app/frontend/app/%28auth%29/Signin/page.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/app/(auth)/Signin/page.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/(auth)/Signin/page.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,uXAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAA0Q,GACvS,wCACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 343, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}}]
}